# 产品背景：MySQL-To-Excel 数据导出工具

## 解决的问题

在处理大型 MySQL 数据库时，经常需要将特定的查询结果导出到 Excel 文件中进行进一步分析、报告或共享。手动导出或使用某些数据库客户端工具可能会遇到以下问题：

1.  **内存限制**: 直接导出非常大的数据集可能会消耗大量内存，甚至导致应用程序崩溃。
2.  **效率低下**: 某些工具可能不是为处理大数据量导出而优化的，导致导出过程缓慢。
3.  **格式兼容性**: 需要确保导出的文件是标准的、易于使用的 Excel 格式。
4.  **用户体验**: 缺乏进度反馈，用户不知道导出过程需要多长时间或当前状态。

## 目标用户

-   需要从 MySQL 数据库提取数据进行分析的数据分析师。
-   需要将数据库报告导出为 Excel 格式的开发人员或数据库管理员。
-   任何需要将大量 MySQL 数据便捷地转换为 Excel 文件的用户。

## 工作方式

1.  **配置**: 用户首先需要创建一个 `config.toml` 文件，指定 MySQL 数据库的连接信息（主机、端口、用户名、密码、数据库名）以及要执行的 SQL 查询语句和分页大小 (`page_size`)。
2.  **执行**: 用户在命令行中运行 `mysql-to-excel` 可执行文件（需要将 `config.toml` 放在同一目录下）。
3.  **连接与计数**: 程序读取配置，连接到指定的 MySQL 数据库，并首先执行一个 `COUNT(*)` 查询来获取总行数，以便计算总页数和设置进度条。
4.  **获取列名**: 执行一次查询（可能有限制，如 `LIMIT 1`，虽然当前代码似乎是直接执行完整查询来获取列名）以获取结果集的列名。
5.  **分页查询**: 程序根据 `page_size` 和总行数，循环执行分页查询（使用 `LIMIT` 和 `OFFSET`）。
6.  **写入 Excel**:
    -   创建一个新的 Excel 工作簿 (`data.xlsx`)。
    -   将获取到的列名写入 Excel 文件的第一行。
    -   在每次分页查询后，将获取到的数据逐行追加到 Excel 文件中。
    -   程序会尝试将 MySQL 数据类型转换为合适的字符串表示形式写入 Excel。
7.  **进度显示**: 在分页查询和写入过程中，程序会更新控制台上的进度条，显示已处理的行数、总行数、百分比和预计剩余时间。
8.  **完成**: 所有数据导出完成后，程序保存 `data.xlsx` 文件，并在控制台显示完成消息。

## 用户体验目标

-   **简单易用**: 通过简单的配置文件和命令行执行即可完成任务。
-   **高效可靠**: 能够稳定处理大数据量，并通过分页避免内存问题。
-   **透明反馈**: 通过进度条提供清晰的导出状态反馈。
-   **标准输出**: 生成通用的 `.xlsx` 格式文件，方便后续使用。
